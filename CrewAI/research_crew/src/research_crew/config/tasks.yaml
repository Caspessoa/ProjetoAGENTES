# config/tasks.yaml

tarefa_oferta_agricultor:
  description: >
    Your reference data is:
    ---
    {conteudo_tabela_agricultor}
    ---
    Based **strictly** on this data, define an initial selling price.
    You MUST also state a fictional amount of pollution you will generate
    (between 5 and 15 units).
  expected_output: >
    A simple text report with your proposal.
    Example: 'Minha proposta é R$ 175,00 pela saca. Estimo que minha produção
    irá gerar 8 unidades de poluição.'

tarefa_resposta_empresario:
  description: >
    Your reference data is:
    ---
    {conteudo_tabela_empresario}
    ---
    Analyze the farmer's proposal (available in the context).
    1.  Decide on the final purchase price (e.g., meet in the middle, or accept).
    2.  State the fictional pollution *you* will generate (between 10 and 25 units).
    3.  **Calculate and report the new equity (patrimônio) for both you and the farmer.**
        (Use the 'patrimônio atual' from the reference tables and the 'preco_final_acordado').
  expected_output: >
    A simple text report detailing:
    1.  O preço final acordado (ex: 'Aceito pagar R$ 160,00').
    2.  A poluição gerada (ex: 'Minha fábrica gerará 15 unidades de poluição').
    3.  O cálculo do novo patrimônio (ex: 'Patrimônio Agricultor: R$ 20.000 + R$ 160 = R$ 20.160.
        Patrimônio Empresário: R$ 100.000 - R$ 160 = R$ 99.840').
  context:
    - 'tarefa_oferta_agricultor'

tarefa_fiscalizacao:
  description: >
    The municipal reference law is:
    ---
    {conteudo_lei_municipal}
    ---
    Based on the reports from the two previous tasks, analyze the pollution levels
    generated by the Farmer and the Businessman.
    1.  Determine if they are above the legal limits (Art. 1).
    2.  State the **exact fine** (multa) for each, according to Art. 2 and Art. 3.
  expected_output: >
    A detailed inspection report, citing the Articles of the law and the
    exact monetary value of the fine for both producers.
  context:
    - 'tarefa_oferta_agricultor' # Precisamos da poluição do agricultor
    - 'tarefa_resposta_empresario' # Precisamos da poluição do empresário

tarefa_relatorio_ong:
  description: >
    Your external research reference data is:
    ---
    {conteudo_pesquisa_web}
    ---
    Based **strictly** on this external data AND the production/inspection reports,
    prepare a persuasive environmental impact report.
    **You must mention the fines calculated by the inspector.**
  expected_output: >
    A formal document (email or letter) addressed to the Mayor and
    Councilor, summarizing the pollution, the fines, and demanding action.
  context:
    - 'tarefa_resposta_empresario'
    - 'tarefa_fiscalizacao'

tarefa_politica_reguladores:
  description: >
    You (Mayor and Councilor) have received the reports.
    Analyze the 'recurso_gerado_total' (total resource generated) and the
    **total fines** calculated by the inspector.
    Based on these numbers, negotiate and define a mitigation policy.
  expected_output: >
    A short "Municipal Law" detailing the mitigation policy.
  context:
    - 'tarefa_relatorio_ong'
    - 'tarefa_fiscalizacao' # Adicionado para garantir que eles vejam as multas

tarefa_sumario_geral:
  description: >
    Compile a final markdown report that summarizes the results of
    all preceding tasks.
    **The report MUST be structured as a table with the following columns:**
    | Etapa da Simulação | Agente Responsável | Resumo da Decisão | Impacto (Poluição) | Impacto (Financeiro) |
  expected_output: >
    A complete final report in Markdown format, portuguese brazilian, structured **only**
    as a table as requested in the description.
  output_file: 'report.md'
  context:
    - 'tarefa_oferta_agricultor'
    - 'tarefa_resposta_empresario'
    - 'tarefa_fiscalizacao'
    - 'tarefa_relatorio_ong'
    - 'tarefa_politica_reguladores'